---
title: "Running survey demographics"
author: "Alicia Vo"
date: "2024-10-07"
output: html_document
---
## Purpose: Running survey demographics

# Pull data from database.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
library(data.table)
library(dplyr)
library(RPostgreSQL)
library(purrr)
library(stringr)
library(tibble)
library(tidyr)
library(devtools) 

# Connect to postgres
source("W:\\RDA Team\\R\\credentials_source.R")
con <- connect_to_db("bold_vision")

source("W:\\RDA Team\\R\\Github\\RDA Functions\\main\\RDA-Functions\\Utility_Functions.R")

# Pull in the data dictionary
svy_dd <- dbGetQuery(con, "SELECT * FROM youth_thriving.bvys_datadictionary_2024")

# Pull in the raw survey data 
svy_data <- dbGetQuery(con, "SELECT * FROM youth_thriving.raw_survey_data")

# Pull in table of respondents with recoded race/ethnicity
race_ethnicity_data <- dbGetQuery(con, "SELECT * FROM youth_thriving.race_ethnicity_data")

total_respondents <- nrow(svy_data)
```

# Calculate the frequencies and percentages of each race category.
```{r}
race_demographics_df <- race_ethnicity_data %>%
  count(nh_race) %>%  # Count occurrences of each unique value the the column
  rename(count = n) %>%
  mutate(variable_name = 'Non-Hispanic race', percentage = count/total_respondents*100) %>%
  select(variable_name, everything())
```

# Calculate the frequencies and percentages of regional Asian categories (i.e. South Asian, Southeast Asian). Percentages are based on the total count of Asian Americans being the denominator.
# TODO: Pivot to long
```{r}
# total_asian <- race_demographics_df$race_asian_count
# 
# asian_regional_demographics_df <- race_ethnicity_data %>%
#   summarise(
#     southeast_asian_count = sum(isSoutheastAsian),
#     southeast_asian_pct = round((100 * southeast_asian_count / total_asian), 1),
#     south_asian_count = sum(isSouthAsian),
#     south_asian_pct = round((100 * south_asian_count / total_asian), 1)
#   )
```

# Calculate the frequencies and percentages of detailed Asian ethnicities.
```{r}
asian_ethnicity_demographics_df <- race_ethnicity_data %>%
  filter(!is.na(detailed_asian) & detailed_asian!="") %>%  # Remove rows where detailed_asian is NA
  count(detailed_asian) %>%  # Count occurrences of each unique value in the column
  rename(count = n) %>%
  mutate(variable_name = 'Asian detailed ethnicity', percentage = count/sum(count)*100) %>%
  arrange(desc(percentage)) %>%  # Arrange by percentage in descending order
  select(variable_name, everything())
```

# Calculate the frequencies and percentages of detailed NHPI ethnicities. 
# TODO: Edit detailed_nhpi column in recording_race.Rmd so that it adds the "Other NHPI" ethnicities as well - similar to the edits made to the detailed_asian column
```{r}
# nhpi_ethnicity_demographics_df <- race_ethnicity_data %>%
#   filter(!is.na(detailed_nhpi) & detailed_nhpi!="") %>%  
#   count(detailed_nhpi) %>%  # Count occurrences of each unique value in the column
#   rename(count = n) %>%
#   mutate(variable_name = 'NHPI detailed ethnicity', percentage = count/sum(count)*100) %>%
#   arrange(desc(percentage)) %>%  # Arrange by percentage in descending order
#   select(variable_name, everything())
```

```{r}
# total_nhpi <- race_demographics_df$race_nhpi_count
# 
# # Step 1: Create a column for the number of ethnicities listed by counting semicolons
# nhpi_ethnicity_data <- race_ethnicity_data %>%
#   filter(detailed_nhpi != "") %>%  # Remove any empty entries
#   mutate(num_ethnicities = str_count(detailed_nhpi, ";") + 1) %>% # Count number of ethnicities
#   select(detailed_nhpi, num_ethnicities)
# 
# # Step 2: Split ethnicities into separate rows but retain fractional counts
# nhpi_ethnicity_fractions <- nhpi_ethnicity_data %>%
#   separate_rows(detailed_nhpi, sep = "; ") %>%  # Split by semicolon
#   group_by(detailed_nhpi) %>% # Group by each NHPI ethnicity
#   summarise(nhpi_ethnic_count = round(sum(1 / num_ethnicities), 1))  # Sum fractions
# 
# # Step 3: Calculate percentages
# nhpi_ethnicity_demographics_df <- nhpi_ethnicity_fractions %>%
#   mutate(nhpi_pop_pct = round(100 * nhpi_ethnic_count / total_nhpi, 1))  # Calculate percentage
# 
# # View the results
# print(nhpi_ethnicity_demographics_df)
```

```{r}
# Bind the data frames into one long data frame
# race_demographics <- bind_rows(
#   race_demographics_df,
#   asian_regional_demographics_df,
#   asian_ethnicity_demographics_df,
#   nhpi_ethnicity_demographics_df
# )
# 
# # View the combined data frame
# print(race_demographics)
```

# Calculate the frequencies and percentages of gender identities.
```{r}
# vars contains the column names and response values of a question domain (e.g. race)
vars<-svy_dd %>% 
  filter(variable_name=='Gender') %>% 
  select(variable,response_1)

df <- svy_data %>%
  select(all_of(vars$variable)) %>%  # Select all of the question domain's columns in the raw data
  mutate(across(where(is.character), ~ ifelse(!is.na(.), 1, 0))) %>% # Convert non-numeric values to 0/1
  summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>% # Sum up numeric columns, ignoring NA
  mutate(variable_name = 'Gender')

gender_demographics_df<-df %>% 
  pivot_longer(!variable_name,names_to='variable',values_to='count') %>%
  left_join(vars, by="variable") %>% 
  mutate(percentage = count/total_respondents * 100) %>%
  select(variable_name, variable, response_1, count, percentage)
```

# Calculate the frequencies and percentages of sexualities.
```{r}
# vars contains the column names and response values of a question domain (e.g. race)
vars<-svy_dd %>% 
  filter(variable_name=='Sexual Orientation') %>% 
  select(variable,response_1)

df <- svy_data %>%
  select(all_of(vars$variable)) %>%  # Select all of the question domain's columns in the raw data
  mutate(across(where(is.character), ~ ifelse(!is.na(.), 1, 0))) %>% # Convert non-numeric values to 0/1
  summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>% # Sum up numeric columns, ignoring NA
  mutate(variable_name = 'Sexual Orientation')

sexuality_demographics_df<-df %>% 
  pivot_longer(!variable_name,names_to='variable',values_to='count') %>%
  left_join(vars, by="variable") %>% 
  mutate(percentage = count/total_respondents * 100) %>%
  select(variable_name, variable, response_1, count, percentage)
```

# Calculate frequencies and percentages for school type enrollment.
```{r}
# education_demographics_df <- svy_data %>%
#   summarise(
#     middle_school_count = sum(ca, na.rm = TRUE),
#     middle_school_pct = round(100 * middle_school_count / total_respondents, 1),
#     
#     high_school_count = sum(cb, na.rm = TRUE),
#     high_school_pct = round(100 * high_school_count / total_respondents, 1),
#     
#     vocational_trade_school_count = sum(cc, na.rm = TRUE),
#     vocational_trade_school_pct = round(100 * vocational_trade_school_count / total_respondents, 1),
#     
#     community_college_count = sum(cd, na.rm = TRUE),
#     community_college_pct = round(100 * community_college_count / total_respondents, 1),
#     
#     four_year_college_count = sum(ce, na.rm = TRUE),
#     four_year_college_pct = round(100 * four_year_college_count / total_respondents, 1),
#     
#     education_dont_wish_to_answer_count = sum(cf, na.rm = TRUE),
#     education_dont_wish_to_answer_pct = round(100 * education_dont_wish_to_answer_count / total_respondents, 1)
#   )
# print(education_demographics_df)
```

# Calculate frequencies and percentages of employment status.
# DO NOT USE: the codebook has an error. instead of column bw being the "other" repsonses, column bz contains the "other" responses. this makes me unsure of what exactly the other columns are referring to. awaiting a response from the survey people.
```{r}
employment_demographics_df <- as.data.frame(NA)
# employment_demographics_df <- svy_data %>%
#   summarise(
#     full_time_employment_count = sum(bt, na.rm = TRUE),
#     full_time_employment_pct = round(100 * full_time_employment_count / total_respondents, 1),
#     
#     full_time_student_count = sum(bu, na.rm = TRUE),
#     full_time_student_pct = round(100 * full_time_student_count / total_respondents, 1),
#     
#     looking_for_work_count = sum(bv, na.rm = TRUE),
#     looking_for_work_pct = round(100 * looking_for_work_count / total_respondents, 1),
# 
#     part_time_employment_count = sum(bx, na.rm = TRUE),
#     part_time_employment_pct = round(100 * part_time_employment_count / total_respondents, 1),
#     
#     part_time_student_count = sum(by, na.rm = TRUE),
#     part_time_student_pct = round(100 * part_time_student_count / total_respondents, 1),
#     
#     dont_wish_to_answer_count = sum(bw, na.rm = TRUE),
#     dont_wish_to_answer_pct = round(100 * dont_wish_to_answer_count / total_respondents, 1),
#     
#     other_count = sum(!is.na(bz) & bz != ""),  # Count non-empty "Other" responses
#     other_pct = round(100 * other_count / total_respondents, 1)
#         
#     )
# print(employment_demographics_df)
```

```{r}
# # Bind the data frames into one long data frame
# education_employment_demographics <- bind_rows(
#   education_demographics_df,
#   employment_demographics_df # This is empty right now, awaiting response from survey people
# )
# 
# # View the combined data frame
# print(education_employment_demographics)
```

# Calculate the frequencies and percentages of system involvement.
# Q24. At any point have you: Lived in foster care, spent time in juvenile hall or probation camp, spent time in jail or prison, lived in a group home or residential program, or lived with relatives who were responsible for you legally? 

# template
```{r}
# vars contains the column names and response values of a question domain (e.g. race)
vars<-svy_dd %>% 
  filter(variable_name=='Race') %>% 
  select(variable,response_1)

df <- svy_data %>%
  select(all_of(vars$variable)) %>%  # Select all of the race columns in the raw data
  mutate(across(where(is.character), ~ ifelse(!is.na(.), 1, 0))) %>% # Convert specific non-numeric values
  summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>% # Sum up numeric columns, ignoring NA
  mutate(variable_name = 'Race')

df_long<-df %>% 
  pivot_longer(!variable_name,names_to='variable',values_to='count') %>%
  left_join(vars, by="variable") %>% 
  filter(variable != 'race') %>%
  mutate(percentage = count/total_respondents * 100) %>%
  select(variable_name, variable, response_1, count, percentage)
```

```{r}
# vars contains the column names and response values of a question domain (e.g. race)
vars<-svy_dd %>% 
  filter(variable_name=='System Involvement') %>% 
  select(variable,response_1)

df <- svy_data %>%
  select(all_of(vars$variable)) %>%  # Select all of the race columns in the raw data
  mutate(across(where(is.character), ~ ifelse(!is.na(.), 1, 0))) %>% # Convert specific non-numeric values
  summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>% # Sum up numeric columns, ignoring NA
  mutate(variable_name = 'System Involvement')

system_involved_demographics_df<-df %>% 
  pivot_longer(!variable_name,names_to='variable',values_to='count') %>%
  left_join(vars, by="variable") %>% 
  mutate(percentage = count/total_respondents * 100) %>%
  select(variable_name, variable, response_1, count, percentage)
```

```{r}
# Step 1: Filter respondents who answered "Yes" (1) to Q24
system_involved_data <- svy_data %>% filter(q24 == 1)

# Step 3: Summarise the frequency and percentage for each item in Q24a
system_involved_demographics_df <- system_involved_data %>%
  summarise(
    system_involved_count = nrow(system_involved_data), # Calculate total number of system involved respondents
    system_involved_pct = round(100 * system_involved_count / total_respondents, 1),
    
    foster_care_count = sum(ga, na.rm = TRUE),
    foster_care_pct = round(100 * foster_care_count / total_respondents, 1),
    
    lived_with_relatives_count = sum(gb, na.rm = TRUE),
    lived_with_relatives_pct = round(100 * lived_with_relatives_count / total_respondents, 1),
    
    juvenile_hall_count = sum(gc, na.rm = TRUE),
    juvenile_hall_pct = round(100 * juvenile_hall_count / total_respondents, 1),
    
    group_home_count = sum(gd, na.rm = TRUE),
    group_home_pct = round(100 * group_home_count / total_respondents, 1),
    
    jail_prison_count = sum(ge, na.rm = TRUE),
    jail_prison_pct = round(100 * jail_prison_count / total_respondents, 1),
    
    system_involved_dont_wish_to_answer_count = sum(gf, na.rm = TRUE),
    system_involved_dont_wish_to_answer_pct = round(100 * system_involved_dont_wish_to_answer_count / total_respondents, 1),
    
    system_involved_other_count = sum(!is.na(gg) & gg != ""),  # Count non-empty "Other" responses
    system_involved_other_pct = round(100 * system_involved_other_count / total_respondents, 1)
  )

# Step 4: View the results
print(system_involved_demographics_df)

```
# Calculate frequencies and percentages of law enforcement involvement.
# Q25. At any point, have you ever been detained AND/OR arrested by law enforcement in any capactiy?
```{r}
arrested_demographics_df <- svy_data %>%
  summarise(
    arrested_yes_count = sum(q25 == 1, na.rm = TRUE),  # Count of "Yes" responses
    arrested_yes_pct = round(100 * arrested_yes_count / total_respondents, 1),  # Percentage of "Yes"
    
    arrested_no_count = sum(q25 == 2, na.rm = TRUE),  # Count of "No" responses
    arrested_no_pct = round(100 * arrested_no_count / total_respondents, 1),  # Percentage of "No"
    
    arrested_dont_wish_to_answer_count = sum(q25 == 3, na.rm = TRUE),  # Count of "Don't wish to answer"
    arrested_dont_wish_to_answer_pct = round(100 * arrested_dont_wish_to_answer_count / total_respondents, 1)  # Percentage of "Don't wish to answer"
  )

# View the results
print(arrested_demographics_df)
```
#Q26. At any point, have you ever been suspended, experienced an "opportunity transfer", been expelled, have been sent out of class by a teacher, had your parents contacted for a school-based incident, or arrested at school? 
```{r}
# Step 1: Calculate frequencies and percentages for Q26
school_discipline_demographics_df <- svy_data %>%
  summarise(
    school_discipline_yes_count = sum(q26 == 1, na.rm = TRUE),  # Count of "Yes" responses
    school_discipline_yes_pct = round(100 * school_discipline_yes_count / total_respondents, 1),  # Percentage of "Yes"
    
    school_discipline_no_count = sum(q26 == 2, na.rm = TRUE),  # Count of "No" responses
    school_discipline_no_pct = round(100 * school_discipline_no_count / total_respondents, 1),  # Percentage of "No"
    
    school_discipline_dont_wish_to_answer_count = sum(q26 == 3, na.rm = TRUE),  # Count of "Don't wish to answer"
    school_discipline_dont_wish_to_answer_pct = round(100 * school_discipline_dont_wish_to_answer_count / total_respondents, 1)  # Percentage of "Don't wish to answer"
  )

# View the results
print(school_discipline_demographics_df)

```

# Calculate the frequencies and percentages of immigration system involvement. 
# Q27: Do any of the following apply to you: Temporary Protected Status, Asylum Status, Refugee Status, Differed Action for Childhood Arrivals (DACA), Non-Citizen Resident?

```{r}
immigration_demographics_df <- svy_data %>%
  summarise(
    immigrant_yes_count = sum(q27 == 1, na.rm = TRUE),
    immigrant_yes_pct = round(100 * immigrant_yes_count / total_respondents, 1),
    
    immigrant_no_count = sum(q27 == 2, na.rm = TRUE),
    immigrant_no_pct = round(100 * immigrant_no_count / total_respondents, 1),
    
    immigrant_dont_know_count = sum(q27 == 3, na.rm = TRUE),
    immigrant_dont_know_pct = round(100 * immigrant_dont_know_count / total_respondents, 1),
    
    immigrant_dont_wish_to_answer_count = sum(q27 == 4, na.rm = TRUE),
    immigrant_dont_wish_to_answer_pct = round(100 * immigrant_dont_wish_to_answer_count / total_respondents, 1),
    
    immigrant_other_count = sum(q27 == 5, na.rm = TRUE),
    immigrant_other_pct = round(100 * immigrant_other_count / total_respondents, 1)
  )
print(immigration_demographics_df)
```
# Calculate the frequencies and percentages of unhoused. 
# Q28. In the past year, was there ever a time when you were homeless or had to stay in any of the following places: A shelter or emergency housing, garage, transitional housing program, motel or hotel, a car, a park, campground, another public place, trailer, motor home, temporarily in the home of a friend, family or another person?
```{r}
unhoused_demographics_df <- svy_data %>%
  summarise(
    unhoused_yes_count = sum(q28 == 1, na.rm = TRUE),
    unhoused_yes_pct = round(100 * unhoused_yes_count / total_respondents, 1),
    
    unhoused_no_count = sum(q28 == 2, na.rm = TRUE),
    unhoused_no_pct = round(100 * unhoused_no_count / total_respondents, 1),
    
    unhoused_dont_know_count = sum(q28 == 3, na.rm = TRUE),
    unhoused_dont_know_pct = round(100 * unhoused_dont_know_count / total_respondents, 1),
    
    unhoused_dont_wish_to_answer_count = sum(q28 == 4, na.rm = TRUE),
    unhoused_dont_wish_to_answer_pct = round(100 * unhoused_dont_wish_to_answer_count / total_respondents, 1)
  )
print(unhoused_demographics_df)
```


```{r}
# Bind the data frames into one long data frame
system_involvement_demographics <- bind_rows(
  system_involved_demographics_df,
  arrested_demographics_df,
  school_discipline_demographics_df,
  immigration_demographics_df,
  unhoused_demographics_df
)

# View the combined data frame
print(system_involvement_demographics)
```
# Tables are race_demographics, gender_sexuality_demographics, education_employment_demographics, system_involvement_demographics

# Export race_demographics dataframe as a table with comments
```{r}
# Write table race_demographics_df with metadata
schema <- "youth_thriving"
table_name <- "race_demographics"
indicator <- "Frequencies and percentages of non-Hispanic race categories"
source <- "script: W:/Project/OSI/Bold Vision/Youth Thriving Survey/GitHub/AV/boldvision_youththriving/getting_demographics.Rmd"
qa_filepath <- "W:/Project/OSI/Bold Vision/Youth Thriving Survey/Documentation/QA_getting_demographics"
table_comment <- paste0(indicator, source)
dbWriteTable(con, c(schema, table_name), race_demographics_df,
             overwrite = TRUE, row.names = FALSE)

# Add metadata for race_demographics_df
column_names <- colnames(race_demographics_df) # Get column names
column_comments <- c(
  'This table uses non-Hispanic race categories',
  'This column has all of the non-Hispanic race categories',
  'Denotes the number of respondents with the corresponding racial identity',
  'Denotes the percentage of respondents with the corresponding racial identity')

add_table_comments(con, schema, table_name, indicator, source, qa_filepath, column_names, column_comments) 
```

# Export asian_ethnicity_demographics_df dataframe as a table with comments
```{r}
# Write table asian_ethnicity_demographics_df with metadata
schema <- "youth_thriving"
table_name <- "asian_ethnicity_demographics"
indicator <- "Frequencies and percentages of detailed Asian ethnicity categories"
source <- "script: W:/Project/OSI/Bold Vision/Youth Thriving Survey/GitHub/AV/boldvision_youththriving/getting_demographics.Rmd"
qa_filepath <- "W:/Project/OSI/Bold Vision/Youth Thriving Survey/Documentation/QA_getting_demographics"
table_comment <- paste0(indicator, source)
dbWriteTable(con, c(schema, table_name), asian_ethnicity_demographics_df,
             overwrite = TRUE, row.names = FALSE)

# Add metadata for asian_ethnicity_demographics_df
column_names <- colnames(asian_ethnicity_demographics_df) # Get column names
column_comments <- c(
  'This table uses detailed Asian ethnic categories',
  'This column has all of the Asian ethnic categories',
  'Denotes the number of respondents with the corresponding ethnic identity',
  'Denotes the percentage of respondents with the corresponding ethnic identity')

add_table_comments(con, schema, table_name, indicator, source, qa_filepath, column_names, column_comments) 
```

# Export gender_sexuality_demographics dataframe as a table with comments
```{r}
# Write table gender_sexuality_demographics with metadata
schema <- "youth_thriving"
table_name <- "gender_sexuality_demographics"
indicator <- "Frequencies and percentages of gender and sexuality groups"
source <- "script: W:/Project/OSI/Bold Vision/Youth Thriving Survey/GitHub/AV/boldvision_youththriving/getting_demographics.Rmd"
qa_filepath <- "W:/Project/OSI/Bold Vision/Youth Thriving Survey/Documentation/QA_getting_demographics"
table_comment <- paste0(indicator, source)
dbWriteTable(con, c(schema, table_name), gender_sexuality_demographics,
             overwrite = TRUE, row.names = FALSE)

# Add metadata for gender_sexuality_demographics
column_names <- colnames(gender_sexuality_demographics) # Get column names
column_comments <- c(
  'The columns called [insert gender]_count give the number of respondents who identified with the specified gender',
  'The columns called [insert gender]_pct give the percentage of respondents who identified with the specified gender',
  rep(NA, 18),
  'The columns called [insert sexuality]_count give the number of respondents who identified with the specified sexuality',
  'The columns called [insert sexuality]_pct give the percentage of respondents who identified with the specified sexuality')

add_table_comments(con, schema, table_name, indicator, source, qa_filepath, column_names, column_comments) 
```
# Export education_employment_demographics dataframe as a table with comments
```{r}
# Write table education_employment_demographics with metadata
schema <- "youth_thriving"
table_name <- "education_employment_demographics"
indicator <- "Frequencies and percentages of education and employment groups"
source <- "script: W:/Project/OSI/Bold Vision/Youth Thriving Survey/GitHub/AV/boldvision_youththriving/getting_demographics.Rmd"
qa_filepath <- "W:/Project/OSI/Bold Vision/Youth Thriving Survey/Documentation/QA_getting_demographics"
table_comment <- paste0(indicator, source)
dbWriteTable(con, c(schema, table_name), education_employment_demographics,
             overwrite = TRUE, row.names = FALSE)

# Add metadata for education_employment_demographics
column_names <- colnames(education_employment_demographics) # Get column names
column_comments <- c(
  'The columns called [insert school type]_count give the number of respondents who attend the specified school type',
  'The columns called [insert school type]_pct give the percentage of respondents who attend the specified school type')

add_table_comments(con, schema, table_name, indicator, source, qa_filepath, column_names, column_comments) 
```

# Export system_involvement_demographics dataframe as a table with comments
```{r}
# Write table system_involvement_demographics with metadata
schema <- "youth_thriving"
table_name <- "system_involvement_demographics"
indicator <- "Frequencies and percentages of system involved groups"
source <- "script: W:/Project/OSI/Bold Vision/Youth Thriving Survey/GitHub/AV/boldvision_youththriving/getting_demographics.Rmd"
qa_filepath <- "W:/Project/OSI/Bold Vision/Youth Thriving Survey/Documentation/QA_getting_demographics"
table_comment <- paste0(indicator, source)
dbWriteTable(con, c(schema, table_name), system_involvement_demographics,
             overwrite = TRUE, row.names = FALSE)

# Add metadata for system_involvement_demographics
column_names <- colnames(system_involvement_demographics) # Get column names
column_comments <- c(
  'Count of respondents who are involved in the system, as defined by the survey',
  'Percentage of respondents who are involved in the system, as defined by the survey',
  'The columns called [insert system type]_count give the number of respondents who are involved with the specified system',
  'The columns called [insert system type]_pct give the percentage of respondents who are involved with the specified system',
  rep(NA, 12),
  'Count of respondents who have been detained or arrested',
  'Percentage of respondents who have been detained or arrested',
  'Count of respondents who have been NOT detained or arrested',
  'Percentage of respondents who have NOT been detained or arrested',
  rep(NA, 2),
  'Count of respondents who have been disciplined at school',
  'Percentage of respondents who have been disciplined at school',
  'Count of respondents who have NOT been disciplined at school',
  'Percentage of respondents who have NOT been disciplined at school',
  rep(NA, 2),
  'Count of respondents who are involved with the immigration system',
  'Percentage of respondents who are involved with the immigration system',
  'Count of respondents who are NOT involved with the immigration system',
  'Percentage of respondents who are NOT involved with the immigration system',
  rep(NA, 6),
  'Count of respondents who are unhoused',
  'Percentage of respondents who are unhoused',
  'Count of respondents who are NOT unhoused',
  'Percentage of respondents who are NOT unhoused'  
  )

add_table_comments(con, schema, table_name, indicator, source, qa_filepath, column_names, column_comments) 
```

```{r}
dbDisconnect(con)
```

